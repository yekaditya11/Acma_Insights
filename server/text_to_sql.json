{
  "history": [
    {
      "type": "human",
      "content": "Top 3 suppliers by On-Time Delivery in 2025"
    },
    {
      "type": "ai",
      "content": "SELECT supplier_name, AVG(value) AS avg_value\nFROM public.supplier_kpi_monthly\nWHERE kpi_name = 'okDeliveryPercent' AND year = 2025\nGROUP BY supplier_name\nORDER BY avg_value DESC\nLIMIT 3;"
    },
    {
      "type": "ai",
      "content": "In 2025, the top three suppliers for On-Time Delivery are Ankita_Auto and Acute_Wiring, both achieving a perfect average of 100%, and Unique_Systems, whose delivery rate data is unavailable."
    }
  ],
  "question": "Top 3 suppliers by On-Time Delivery in 2025",
  "intent": "system_query",
  "semantic_info": {
    "table": "supplier_kpi_monthly",
    "table_comment": "Monthly supplier KPIs captured per month with a unique constraint on (supplier_name, kpi_name, year, month).",
    "columns": [
      {
        "name": "id",
        "type": "BIGINT",
        "nullable": false,
        "description": "Surrogate primary key for the row.",
        "is_primary_key": true,
        "is_foreign_key": false
      },
      {
        "name": "supplier_name",
        "type": "TEXT",
        "nullable": false,
        "description": "Supplier identifier/name to which the KPI value applies. | Sample values: Acute_Wiring, Ankita_Auto, CAM, Daxter, JJ_Tecnoplast, Kamal, Laxmi_SPRINGS, Makarjyothi, S_B_Precision_Springs, Shree_Stamping, Unique_Systems, Victor_Engineers_ASAL",
        "is_primary_key": false,
        "is_foreign_key": false
      },
      {
        "name": "kpi_name",
        "type": "TEXT",
        "nullable": false,
        "description": "Name of the KPI metric| Sample values: accidents, machineBreakdowns, machineDowntimeHrs, okDeliveryPercent, partsPerTrip, productionLossHrs, quantityShipped, trips, vehicleTAT",
        "is_primary_key": false,
        "is_foreign_key": false
      },
      {
        "name": "year",
        "type": "INTEGER",
        "nullable": false,
        "description": "Calendar year of the KPI measurement.",
        "is_primary_key": false,
        "is_foreign_key": false
      },
      {
        "name": "month",
        "type": "SMALLINT",
        "nullable": false,
        "description": "Calendar month of the KPI measurement (1-12).",
        "is_primary_key": false,
        "is_foreign_key": false
      },
      {
        "name": "value",
        "type": "NUMERIC",
        "nullable": true,
        "description": "Numeric KPI value for the supplier and month.",
        "is_primary_key": false,
        "is_foreign_key": false
      },
      {
        "name": "unit",
        "type": "TEXT",
        "nullable": true,
        "description": "Unit of measure for the KPI value| Sample values: Number of parts shipped by the supplier, Number of shipment trips completed per month, Production hours lost due to supplier-caused material shortage, Efficiency metric showing avg. parts shipped per trip, Number of safety incidents reported, Number of machine breakdowns, Machine breakdown time (in hours), Average vehicle turnaround time at the plant (in hours), Percentage of OK deliveries based on ACMA standards",
        "is_primary_key": false,
        "is_foreign_key": false
      },
      {
        "name": "generated_on",
        "type": "DATE",
        "nullable": true,
        "description": "Date the KPI value was generated or sourced.",
        "is_primary_key": false,
        "is_foreign_key": false
      },
      {
        "name": "created_at",
        "type": "TIMESTAMP",
        "nullable": false,
        "description": "Timestamp when the record was inserted.",
        "is_primary_key": false,
        "is_foreign_key": false
      }
    ],
    "constraints": {
      "primary_key": [
        "id"
      ],
      "unique": [
        [
          "supplier_name",
          "kpi_name",
          "year",
          "month"
        ]
      ],
      "checks": [
        {
          "name": "supplier_kpi_monthly_month_check",
          "sqltext": "month >= 1 AND month <= 12"
        }
      ],
      "foreign_keys": []
    }
  },
  "sql_query": "SELECT supplier_name, AVG(value) AS avg_value\nFROM public.supplier_kpi_monthly\nWHERE kpi_name = 'okDeliveryPercent' AND year = 2025\nGROUP BY supplier_name\nORDER BY avg_value DESC\nLIMIT 3;",
  "query_result": [
    {
      "supplier_name": "Unique_Systems",
      "avg_value": null
    },
    {
      "supplier_name": "Ankita_Auto",
      "avg_value": 100.0
    },
    {
      "supplier_name": "Acute_Wiring",
      "avg_value": 100.0
    }
  ],
  "query_error_message": "",
  "needs_clarification": false,
  "visualization_data": {
    "tooltip": {
      "trigger": "axis",
      "axisPointer": {
        "type": "shadow"
      }
    },
    "xAxis": {
      "type": "category",
      "data": [
        "Unique_Systems",
        "Ankita_Auto",
        "Acute_Wiring"
      ],
      "axisLabel": {
        "rotate": 30
      }
    },
    "yAxis": {
      "type": "value",
      "name": "On-Time Delivery (%)",
      "min": 0,
      "max": 100
    },
    "series": [
      {
        "type": "bar",
        "data": [
          0,
          100,
          100
        ],
        "name": "On-Time Delivery",
        "itemStyle": {
          "color": "#5470C6"
        }
      }
    ],
    "title": {
      "text": "Top 3 Suppliers by On-Time Delivery in 2025",
      "left": "center"
    }
  },
  "final_answer": "In 2025, the top three suppliers for On-Time Delivery are Ankita_Auto and Acute_Wiring, both achieving a perfect average of 100%, and Unique_Systems, whose delivery rate data is unavailable."
}